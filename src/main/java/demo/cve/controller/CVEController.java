package demo.cve.controller;

import org.apache.logging.log4j.LogManager;
import org.apache.logging.log4j.Logger;
import org.springframework.web.bind.annotation.GetMapping;
import org.springframework.web.bind.annotation.RequestHeader;
import org.springframework.web.bind.annotation.RequestParam;
import org.springframework.web.bind.annotation.RestController;

@RestController
public class CVEController {

	private static final Logger LOGGER=LogManager.getLogger(CVEController.class);
	
	
	@GetMapping("/headerexploit")
	public String exploitHeader(@RequestHeader("X-Api-version") String userAgent) {
		 LOGGER.info("user-aget:"+userAgent);
		 return "pawned";
	}
	
	@GetMapping("/exploit")
	public String exploit(@RequestParam("input") String input) {
		 LOGGER.info("User Input:"+input);
		 return "pawned";
	}
	
	
	
	
	
}
